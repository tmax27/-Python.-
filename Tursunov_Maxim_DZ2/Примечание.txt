Не смог разобраться по поводу рекурсии, постараюсь его сделать в ближайшее время.